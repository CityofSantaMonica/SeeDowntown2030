<!DOCTYPE html>
<html>

    <head>
        <meta http-equiv="Cache-Control" content="no-store" />
        <title>Parcels</title>
        <script src="https://connectors.tableau.com/libs/tableauwdc-1.1.1.js" type="text/javascript"></script>
        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js" type="text/javascript"></script>

        <script type="text/javascript">
            (function () {
                var myConnector = tableau.makeConnector();

                myConnector.init = function () {
                    tableau.initCallback();
                    tableau.submit();
                };

                myConnector.getColumnHeaders = function () {
                    var fieldNames = ["AIN", "Situs Address", "Year Built", "Building Square Footage", "Building Height", "Lot Square Footage", "Category", "Category Color"];
                    var fieldTypes = ["string", "string", "string", "float", "float", "float", "string", "string"];
                    tableau.headersCallback(fieldNames, fieldTypes);
                };

                myConnector.getTableData = function (lastRecordToken) {
                    $.getJSON("Tableau.geojson", function (data) {
                        var results = [];
                        for (var i = 0; i < data.features.length; i++) {
                            var feature = data.features[i];
                            var properties = feature.properties;
                            var result = {
                                "AIN": properties["AIN"],
                                "Situs Address": properties["Situs Address"],
                                "Year Built": properties["Year Built"],
                                "Building Square Footage": properties["Building Square Footage"],
                                "Building Height": properties["Building Height"],
                                "Lot Square Footage": properties["Lot Square Footage"],
                                "Category": properties["Category"],
                                "Category Color": properties["Category Color"]
                            };
                            results.push(result);
                        }
                        tableau.dataCallback(results, results.length.toString(), false);
                    });

                };

                tableau.registerConnector(myConnector);
            })();


        </script>
    </head>
    <body>
    </body>
</html>
